function showSettings(){safari.extension.popovers[0].height=304;var e=customer_name.split(" ")[0],t='<div id="navbar">'+showNavbar(1)+'</div><div id="content"><hr><ul id="settings-list"><a class="settings_link" href="'+site_name+'/logout"><li id="not-user-button">Hello '+e+", <span>Not "+e+'?</span><i class="fa fa-chevron-right"></i></li></a><hr><a class="settings_link" href="'+site_name+'/what_is_giftibly"><li>What is Giftibly?</span><i class="fa fa-chevron-right"></i></li></a><hr><li id="incorrect-info-button">My Gift Is Not Showing Correctly<i class="fa fa-chevron-right"></i></li><hr><li id="compare-product-button">Compare This To Similar Products<i class="fa fa-chevron-right"></i></li><hr></ul><hr><a id="privacy-policy" href="'+site_name+'/privacy_policy">Privacy Policy</a></div>';$("body").html(t),$("#back-button").hide(),$("#content").hide().fadeIn(),setTimeout(function(){$("#back-button").fadeIn()},400),document.getElementById("back-button").onclick=function(e){startPopup(item),$("#content").css("height",content_height+"px"),$("#back-button").hide(),e.preventDefault()},$("#incorrect-info-button").click(function(){showItemForm()}),$("#compare-product-button").click(function(){settingsCompareProduct(item)})}function showItemForm(){safari.extension.popovers[0].height=392,document.body.innerHTML='<div id="navbar">'+showNavbar(1)+'</div><div id="content"><div class="report_problem"><p class="problem_title">What seems to be the problem?</p><p class="check_all">Check all that apply.</p><div class="checkbox"><input type="checkbox" name="report" value="Name error"><label>Name of the Gift is wrong.</label></div><br><div class="checkbox"><input type="checkbox" name="report" value="Price error"><label>Price of Gift is wrong.</label></div><br><div class="checkbox"><input type="checkbox" name="report" value="Image error"><label>Gift Image is wrong.</label></div><br><div class="checkbox"><input type="checkbox" name="report" value="Size error"><label>Gift Size is wrong.</label></div><br><div class="checkbox"><input type="checkbox" name="report" value="Color error"><label>Color of Gift is wrong.</label></div><br><button class="report_button" type="button">Report Issue</button>',$("#content").hide().fadeIn(),document.getElementById("back-button").onclick=function(e){showSettings(),$("#content").css("height",content_height+"px"),$("#back-button").hide(),e.preventDefault()},document.getElementById("back-button").onclick=function(e){showSettings(),e.preventDefault()},$(".report_button").click(function(){if($('input[name="report"]').is(":checked")){var e=[];$("input:checkbox[name=report]:checked").each(function(){e.push($(this).val())});var t=e.toString();$.ajax({url:site_name+"/api/v1/errors",type:"POST",headers:{Authorization:giftibly_token_string},data:{url:getOriginURL(),error_type:"reported_issue",note:t},success:function(e){thankyou()},error:function(){console.log("Cannot send data")}})}else $(".check_all").text("Please check a box"),$(".check_all").css("color","#D0443F")}),$(".checkbox input").click(function(){$(".check_all").text("Check all that apply."),$(".check_all").css("color","#aeaeae")})}function settingsCompareProduct(){safari.extension.popovers[0].height=428,document.body.innerHTML='<div id="navbar">'+showNavbar(1)+'</div><p class="assistant-title">See Similar Items</p><div id="content"><p class="assistant-title">See Similar Items</p></div>',$("#content").hide().fadeIn(),document.getElementById("back-button").onclick=function(e){showSettings(),e.preventDefault()},$("#content").addClass("loading_content"),$("#content").html('<div class="loading_item" id="loading-icon"><i class="fa fa-refresh fa-spin fa-fw"></i></div>'),compareProduct()}function compareProduct(){var e,t="%00";item.name&&(t=item.name.replace(/ /g,"+"));var i="https://www.bing.com/shop?q="+t+"&originIGUID";$.ajax({url:i,type:"GET",success:function(i){var o,n=(new DOMParser).parseFromString(i,"text/html");try{o=n.getElementsByClassName("br-items")[0].childNodes}catch(e){o={}}e='<div id="compare-item-div">';for(var a=0;a<o.length;a++){var r="https://www.bing.com"+$(o[a]).attr("data-url");a>0&&(e+='<hr class="hr-comparison">');var c=$(o[a]).find(".br-pdItemName").text(),s=$(o[a]).find(".pd-price").text(),l="https://www.bing.com"+$(o[a]).find(".br-pdMainImg img").attr("src"),d="placeholder";$.ajax({url:r,type:"GET",async:!1,success:function(e){e=$(e).find(".br-pdImg a").attr("href"),d=e,$(".compare-image-div").attr("href",d),$(".compare-name a").attr("href",d)},error:function(){console.log("Error")}}),e=e+'<a class="compare-image-div" href="'+d+'" ><div class="compare-item"><img class="compare-image" alt="'+c+'" src="'+l+'"><p class="compare-name">'+c+'</p><p class="compare-price">'+s+"</div></a>",a>=4&&(a=o.length)}if(o.length){e+='<a href="'+("https://www.google.com/search?q="+t+"&tbm=shop&tbs=vw:g")+'" id="compare-link"><div id="compare-more">See More</div></a>'}else e+='<p style="margin:10px">No similar item found<br>Try to change the item name...</p>';e+="</div>",$("#loading-icon").remove(),$("#content").removeClass("loading_content"),document.getElementById("content").innerHTML+=e,$("#compare-item-div").hide().fadeIn()},error:function(){console.log("Error")}})}function thankyou(){safari.extension.popovers[0].height=295,document.body.innerHTML='<div id="navbar">'+showNavbar()+'</div><div id="content"><div class="thank_you"><img src="../img/happy_box.png" class="box_image"><p class="big-title">Thank you!</p><p class="description">We will work on this right away!</p><button class="exit_button" type="button">Exit</button></div></div>',$("#content").hide().fadeIn(),$(".exit_button").click(function(){safari.self.hide()})}