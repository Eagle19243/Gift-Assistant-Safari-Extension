function isWebsiteUnknown(e){websiteList=getWebsiteList();for(var t=!0,s=0;s<websiteList.length;s++)test=new RegExp(websiteList[s]),test.exec(e)&&(t=!1);return t}function postMessage(e,t){safari.self.tab.dispatchMessage(e,t)}function handleMessage(e){if(window.top===window&&"from_global"==e.name)if("loggin_status"==e.message.type)e.message.logged_in?localStorage.setItem("giftibly_token","added"):localStorage.setItem("giftibly_token","not added");else if("got_item"==e.message.type&&"getItem"==e.message.action){var t=location.hostname.toLowerCase(),s=getItem(t);postMessage("from_injected",{type:"got_item",itemData:s,unknownWebsiteData:isWebsiteUnknown(t)}),isGotItem=!0}}safari.self.addEventListener("message",handleMessage,!1),function(){if($("#ga_logged_in")[0]){postMessage("from_injected",{type:"loggin_status",logged_in:!0,token:$("#ga_logged_in").data("token")})}else $("#ga_logged_out")[0]&&postMessage("from_injected",{type:"loggin_status",logged_in:!1});$(document).ready(function(){$("#gift_assistant_link").remove(),$(".ga_button").remove()}),$(document).on("turbolinks:load",function(){$("#gift_assistant_link").remove(),$(".ga_button").remove()})}();